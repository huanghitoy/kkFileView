<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HUANGHITOY/KKFileViewer</title>
</head>

<body>
    <script src="https://kk.htqh.cloudns.org:10443/js/base64.js" type="application/javascript"></script>
    <script>
    function getQueryParamValue(name) {
        const searchParams = new URLSearchParams(window.location.search);
        return searchParams.get(name);
    }

    let url = decodeURIComponent(getQueryParamValue("url"));
    if (url === "null") {
        console.log("url的参数为空!")
    } else {
        console.log(url);
        const alistRegex = /(\?|&)alist_ts=\d+/;
        if (alistRegex.test(url)) {
            url = url.replace(alistRegex, '');
        }
        
        console.log(url);
        
        url = encodeURIComponent(url); // 对修改后的url进行编码
        console.log(url);
        
        let e_url='https://kk.htqh.cloudns.org:10443/preview/onlinePreview?url='+encodeURIComponent(BASE64.encode(url));
        console.log(e_url);
        window.open('https://kk.htqh.cloudns.org:10443/preview/onlinePreview?url='+encodeURIComponent(BASE64.encode(url)),'_self');
    }
    </script>
	
</body>
</html>

